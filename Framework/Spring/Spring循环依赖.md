# Spring循环依赖

## 什么是循环依赖

- 1、自身依赖于自身 A依赖于A
- 2、互相循环依赖 A依赖于B，B依赖于A
- 3、多组循环依赖 A依赖于B，B依赖于C，C依赖于A

在Spring中针对循环依赖

- 构造依赖：单例还是原型不支持循环依赖
- 依赖注入：只要有一个是单例就支持循环依赖，如果都是原型则不支持循环依赖

## 构造注入

在Spring中构造注入中的`循环依赖`是不被支持的！那么就是需要检测是否产生了`循环依赖`，如果产出就需要抛出异常。

## 依赖注入

在Spring支持单例的循环依赖，不支持原型的循环依赖。

针对依赖注入这种情况产生的`循环依赖`问题，我们解决的方案是`提前暴露`。

但是在Spring中对于Bean实例因为AOP的存在，我们可能返回的并不是原始的Bean对象，而是被AOP增强的代理对象，这时在Spring中需要使用三级缓存来处理。

## 解决依赖方法
- 构造函数注入： 在构造函数中注入依赖项，而不是在属性中注入。
- Setter注入： 使用setter方法注入依赖项，而不是在构造函数中注入。
- 延迟注入： 使用@Lazy注解延迟加载依赖项。
- @Autowired注解的required属性： 将required属性设置为false，以避免出现循环依赖问题。
- @DependsOn注解： 使用@DependsOn注解指定依赖项的加载顺序，以避免出现循环依赖问题
